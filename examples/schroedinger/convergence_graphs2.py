from math import e, log, exp

from pylab import plot, show, savefig, grid, gca, legend, figure, title, \
        xlabel, ylabel


Rn0_x = [25, 31, 37, 43, 49, 67, 79, 103, 115, 133]
#Rn1_x = [23, 35, 41, 47, 59, 71, 83, 95, 107]
#Rn2_x = [23, 29, 35, 41, 47, 65, 77, 95, 107]

R10_y = [0.16676173689459373, 0.038254689188603141, 0.0010677432574189294,
        2.2931902048939357e-06, 1.0921685889009325e-08, 9.8654451274882149e-10,
        9.3617336105467075e-12, 7.0984329525458634e-12, 6.4437344349244086e-13,
        2.8999025403209089e-13]

R20_y = [0.028966792038071301, 0.0030262717329101185, 1.6489249960768837e-05,
        1.7408326863366241e-08, 9.1130985258036645e-09, 3.8598236690168264e-09,
        1.5295875677168169e-11, 2.8138602559124593e-13, 1.0014211682118912e-13,
        -2.3553381467422696e-13]

R30_y = [0.010422065707353885, 0.00068778277817766603, 1.7278464779918457e-06,
        2.8916446515037109e-08, 2.843261607404779e-08, 8.0352775128078591e-09,
        2.276666369316338e-09, 5.9793628381932251e-12, -1.602190602412179e-14,
        4.0821512836686225e-14]

R40_y = [0.0050153980309137862, 0.00025054408623355687, 4.5227925233801147e-07,
        5.223349718377901e-08, 5.2148303317928191e-08, 1.2370829003544026e-08,
        7.4851823489430203e-09, 5.0776650245554222e-11, 5.7518920182353384e-13,
        5.4471357979757329e-13]

#R21_y
#R31_y
#R41_y
#R51_y
#R32_y
#R42_y
#R52_y
#R62_y

def do_plot(x, y, n, l, color="k"):
    n_r = n - l - 1
    styles = {0: "-s", 1: "--o", 2: ":^", 3: "-.v"}
    plot(x, y, color + styles[n_r], label="$R_{%d%d}$" % (n, l))

    grid(True)
    ax = gca()
    xlabel("DOFs")
    ylabel("$E_{num}-E$")
    ax.set_yscale("log")
    title("l=%d" % l)
    legend()

figure()
do_plot(Rn0_x, R10_y, 1, 0, "b")
do_plot(Rn0_x, R20_y, 2, 0, "y")
do_plot(Rn0_x, R30_y, 3, 0, "g")
do_plot(Rn0_x, R40_y, 4, 0)
savefig("conv_dof_l_0.png")

#figure()
#do_plot(Rn1_x, R21_y, 2, 1)
#do_plot(Rn1_x, R31_y, 3, 1)
#do_plot(Rn1_x, R41_y, 4, 1)
#do_plot(Rn1_x, R51_y, 5, 1)
#savefig("conv_dof_l_1.png")
#
#figure()
#do_plot(Rn2_x, R32_y, 3, 2)
#do_plot(Rn2_x, R42_y, 4, 2)
#do_plot(Rn2_x, R52_y, 5, 2)
#do_plot(Rn2_x, R62_y, 6, 2)
#savefig("conv_dof_l_2.png")
#
#show()
